import operator

if __name__ == '__main__':
    firstFire=[]
    flist=[[[['D1', 'J11', 'J46', 'J44', 'F42', 'J44', 'Z05', 'J41', 'J18', 'J29', 'J30', 'F22'], 'C'], 4, [45.12, 42.94, 49.19, 18.11, 18.11, 28.64, 18.97, 22.36, 38.47, 40.05, 20.59]], [[['D1', 'J11', 'J46', 'J44', 'Z05', 'J41', 'F40', 'J41', 'Z05', 'J41', 'J18', 'J29', 'F20'], 'C'], 6, [45.12, 42.94, 49.19, 28.64, 18.97, 20.1, 20.1, 18.97, 18.97, 22.36, 38.47, 18.87]], [[['D1', 'J11', 'J46', 'F43', 'J46', 'J44', 'Z05', 'J41', 'J18', 'J29', 'J28', 'F18'], 'C'], 3, [45.12, 42.94, 17.09, 17.09, 49.19, 28.64, 18.97, 22.36, 38.47, 36.77, 26.08]], [[['D1', 'J11', 'J46', 'J44', 'F41', 'J44', 'Z05', 'J41', 'J18', 'J29', 'J30', 'F21'], 'C'], 4, [45.12, 42.94, 49.19, 25.3, 25.3, 28.64, 18.97, 22.36, 38.47, 40.05, 16.12]], [[['D1', 'J09', 'J08', 'J07', 'Z04', 'J38', 'F34', 'J38', 'Z04', 'J37', 'J15', 'J25', 'F10'], 'C'], 6, [65.39, 20.65, 23.58, 31.62, 20.0, 17.2, 17.2, 20.0, 28.28, 28.07, 47.2, 32.06]], [[['D1', 'J09', 'J08', 'J07', 'Z04', 'J38', 'F35', 'J38', 'Z04', 'J37', 'J15', 'J25', 'F11'], 'C'], 6, [65.39, 20.65, 23.58, 31.62, 20.0, 19.7, 19.7, 20.0, 28.28, 28.07, 47.2, 28.07]], [[['D1', 'J10', 'J45', 'J42', 'J40', 'F38', 'J40', 'J39', 'J16', 'Z06', 'J28', 'F19'], 'B'], 5, [41.5, 39.58, 34.03, 38.33, 17.65, 17.65, 26.11, 26.17, 45.29, 49.12, 13.82]], [[['D1', 'J10', 'J45', 'J42', 'J40', 'F39', 'J40', 'J39', 'J16', 'Z06', 'J26', 'F12'], 'B'], 5, [41.5, 39.58, 34.03, 38.33, 21.68, 21.68, 26.11, 26.17, 45.29, 38.06, 16.88]], [[['D1', 'J10', 'J45', 'J42', 'J40', 'F37', 'J40', 'J39', 'J16', 'Z06', 'J26', 'F13'], 'B'], 5, [41.5, 39.58, 34.03, 38.33, 20.71, 20.71, 26.11, 26.17, 45.29, 38.06, 21.68]], [[['D1', 'Z03', 'J61', 'F58', 'J61', 'Z03', 'J57', 'J58', 'J59', 'J62', 'J60', 'F56'], 'A'], 3, [49.6, 35.0, 13.4, 13.4, 35.0, 29.45, 19.69, 25.3, 32.11, 31.1, 11.31]], [[['D1', 'Z03', 'J57', 'J58', 'J59', 'F54', 'J59', 'J55', 'J54', 'Z02', 'J54', 'J55', 'J59', 'J62', 'F60'], 'A'], 5, [49.6, 29.45, 19.69, 25.3, 16.28, 16.28, 22.71, 25.33, 17.33, 17.33, 25.33, 22.71, 32.11, 13.92]], [[['D1', 'Z03', 'J61', 'F57', 'J61', 'Z03', 'J57', 'J58', 'J59', 'J62', 'J60', 'F55'], 'A'], 3, [49.6, 35.0, 16.49, 16.49, 35.0, 29.45, 19.69, 25.3, 32.11, 31.1, 10.41]], [[['D2', 'J32', 'J33', 'F25', 'J33', 'J04', 'Z01', 'J50', 'J49', 'F48'], 'C'], 3, [37.36, 34.0, 20.4, 20.4, 39.7, 37.58, 36.88, 50.99, 23.32]], [[['D2', 'J03', 'J04', 'J50', 'F50', 'J50', 'Z01', 'J50', 'J53', 'F51'], 'C'], 4, [42.19, 29.81, 45.12, 26.08, 26.08, 36.88, 36.88, 36.22, 22.36]], [[['D2', 'J03', 'J48', 'F47', 'J48', 'Z01', 'J50', 'J53', 'J56', 'F53'], 'C'], 3, [42.19, 36.72, 24.0, 24.0, 46.86, 36.88, 36.22, 53.37, 23.32]], [[['D2', 'J03', 'J48', 'F46', 'J48', 'Z01', 'J50', 'J53', 'J56', 'F52'], 'C'], 3, [42.19, 36.72, 28.28, 28.28, 46.86, 36.88, 36.22, 53.37, 20.0]], [[['D2', 'J02', 'J47', 'F44', 'J47', 'J48', 'Z01', 'J50', 'J49', 'F49'], 'C'], 3, [80.52, 18.44, 21.63, 21.63, 32.25, 46.86, 36.88, 50.99, 22.63]], [[['D2', 'J32', 'J13', 'J21', 'F01', 'J21', 'J14', 'J15', 'J37', 'Z04', 'J37', 'F31'], 'C'], 4, [37.36, 50.04, 40.2, 17.2, 17.2, 36.06, 44.4, 28.07, 28.28, 28.28, 14.42]], [[['D2', 'J32', 'J13', 'J21', 'F02', 'J21', 'J14', 'J15', 'J37', 'Z04', 'J37', 'F32'], 'B'], 4, [32.03, 42.89, 34.46, 14.65, 14.65, 30.9, 37.0, 24.06, 24.24, 24.24, 15.33]], [[['D2', 'J32', 'J13', 'J21', 'F03', 'J21', 'J14', 'J15', 'J37', 'Z04', 'J37', 'F33'], 'B'], 4, [32.03, 42.89, 34.46, 14.55, 14.55, 30.9, 37.0, 24.06, 24.24, 24.24, 20.07]], [[['D2', 'J32', 'J33', 'J34', 'F26', 'J34', 'J36', 'J06', 'J51', 'Z02', 'J51', 'J06', 'J36', 'J34', 'J35', 'F28'], 'B'], 4, [32.03, 29.14, 38.33, 17.14, 17.14, 43.64, 24.54, 14.55, 19.99, 19.99, 14.55, 24.54, 43.64, 25.71, 16.17]], [[['D2', 'J32', 'F24', 'J32', 'J33', 'J34', 'J36', 'J06', 'J51', 'Z02', 'J54', 'J55', 'J59', 'J62', 'F59'], 'A'], 2, [24.91, 12.29, 12.29, 22.67, 29.81, 33.94, 19.09, 11.31, 15.55, 17.33, 25.33, 22.71, 32.11, 17.38]], [[['D2', 'J32', 'J33', 'J34', 'J35', 'F27', 'J35', 'J34', 'J36', 'J06', 'J51', 'Z02', 'J51', 'J06', 'J36', 'F29'], 'A'], 5, [24.91, 22.67, 29.81, 20.0, 12.58, 12.58, 20.0, 33.94, 19.09, 11.31, 15.55, 15.55, 11.31, 19.09, 13.2]], [[['D2', 'J02', 'J47', 'F45', 'J47', 'J48', 'Z01', 'J50', 'J53', 'J55', 'J54', 'Z02', 'J51', 'J06', 'J36', 'F30'], 'A'], 3, [53.68, 12.29, 16.71, 16.71, 21.5, 31.24, 24.59, 24.15, 20.83, 25.33, 17.33, 15.55, 11.31, 19.09, 13.2]]]
    for f in flist:
        ff=0
        for i in range(f[1]):
            # print("iiii",f[-1][i])
            ff+=f[-1][i]
        firstFire.append(ff)

    print("第一次",round(max(firstFire),2))#204.96
    finalTime=[]
    for f in flist:
        b=[]
        sum1=0
        for i in range(len(f[-1])):
           sum1+=f[-1][i]
           b.append(round(sum1,2))
        m=[]
        m.append(f[0])
        m.append(b)
        finalTime.append(m)


    endTime=[]
    SecondFire=[]
    for f in flist:
        b=[]
        sum2=0
        after=204.96
        index = f[1]
        for i in range(len(f[-1])):
            if i<index:
                # print("before",f[-1][i])
                sum2+=f[-1][i]
                b.append(round(sum2, 2))
            else:
                # print("after",f[-1][i])
                after+=f[-1][i]
                b.append((round(after,2)))
        m = []
        m.append(f[0])
        m.append(b)
        endTime.append(m)


    # print(len(endTime))
    for et in endTime:
        print(et)


    SecondFire=[]
    for e in endTime:
        SecondFire.append(e[-1][-1])

    print("第二次发射时间",round(max(SecondFire),2))
    print("总时间",round(sum(SecondFire)))

    count=0
    s=set()
    wordCount=[]

    for e in endTime:
        for  k in e[0][0]:
            if k[0] !='F' and k[0]!='D':
                count+=1
                if k not in s:
                    s.add(k)
                    a=[]
                    a.append(k)
                    a.append(1)
                    wordCount.append(a)
                else:
                    for wc in wordCount:
                        if wc[0]==k:
                            wc[1]=wc[1]+1
    print(count)
    wordCount.sort(key=operator.itemgetter(-1))
    wordCount.reverse()
    print(len(wordCount))
    for wc in wordCount:
        print(wc)
